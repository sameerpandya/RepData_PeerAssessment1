Reproducible Research: Peer Assessment 1
===========================================

## Loading and preprocessing the data
First we unzip the data. Then we'll load the unziped CSV it into a variable called *data*.  
```{r load_data, echo=TRUE}
unzip("activity.zip")
data <- read.csv("activity.csv")
```
  
Then let's look at the data
```{r examine_data, echo=TRUE}
names(data)
head(data)
str(data)
```

Notice that the date column comes in as a Factor. Let's change that the type to Date. The format is YYYY-MM-DD.

```{r change_date_type, echo=TRUE}
data$date <- as.Date(data$date)
str(data)
```

Great! We should be ready to go!
  


## What is mean total number of steps taken per day?
Let's first get rid of the missing values in the data set.
```{r get_rid_of_missing values, echo=TRUE}
dim(data)
nonmissing <- data[complete.cases(data), ]
dim(nonmissing)
```
We can see that the number of rows in the **nonmissing** dataframe is less than in **data**.

Now let's sum up the number of steps in each day. We can do that with the **aggregate()** method. Then create a histogram showing the distribution of the steps walked in each day.

We can add a bit more context by adding a rug to the histogram.

```{r aggregate_steps_by_date, echo=TRUE}
totals <- aggregate(list(TotalStep = nonmissing$steps), by=list(Date = nonmissing$date), FUN = sum)
hist(totals$TotalStep, breaks = 10, col = "blue", xlab = "Total Steps per day", main = "Distribution of Total Steps per Day")
rug(totals$TotalStep)
```

The **mean** is `r toString(mean(totals$TotalStep))` steps and the **median** is `r median(totals$TotalStep)` steps

## What is the average daily activity pattern?
What we need to do here is aggregate over the interval. So first let's look at what the interval looks like.

```{r explore_interval, echo=TRUE}
unique(nonmissing$interval)
```

Note that the values for the interval identify the five minute interval in day. The format is HHMM, that is to say, 2355 corresponds with 23:55 (11:55 PM.)

So now, let's aggreagate over the interval, to get an average number of steps for each five minute interval (over the days in the data set.) and 

```{r aggregate_over_interval, echo=TRUE}
totalsByInterval <- aggregate(list(avgSteps = nonmissing$steps), by=list(interval = nonmissing$interval), FUN = mean)
head(totalsByInterval)
```

Now let's plot the time series.
``` {r plot_aggr_over_interval, echo=TRUE}
plot(totalsByInterval$avgSteps ~ totalsByInterval$interval, type = "l", col = "red", main = "Average Number of Steps Taken by 5-minute Interval (across all days)", ylab = "Average number of steps", xlab = "Interval (in HHMM format)")
```

Which 5-min interval, on average across all the days in the dataset, contains the maximum number of steps?
``` {r max_number_of_steps, echo=TRUE}
maximum <- totalsByInterval[which.max(totalsByInterval$avgSteps), ]
```
The interval with the max number of steps is `r toString(maximum$interval)`, and the max number of steps is `r toString(maximum$avgSteps)`.

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
